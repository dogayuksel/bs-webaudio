// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE

import * as Block from "bs-platform/lib/es6/block.js";
import * as Curry from "bs-platform/lib/es6/curry.js";
import * as React from "react";
import * as Pervasives from "bs-platform/lib/es6/pervasives.js";
import * as ReactDOMRe from "reason-react/src/ReactDOMRe.js";
import * as LFO$WebAudio from "./LFO/LFO.bs.js";
import * as Knob$WebAudio from "./Components/Knob.bs.js";
import * as Slider$WebAudio from "./Components/Slider.bs.js";
import * as Switch$WebAudio from "./Components/Switch.bs.js";
import * as Envelope$WebAudio from "./Envelope/Envelope.bs.js";
import * as Oscillator$WebAudio from "./Oscillator/Oscillator.bs.js";
import * as AudioContext$WebAudio from "./WebAudio/AudioContext.bs.js";
import * as BiquadFilterNode$WebAudio from "./WebAudio/BiquadFilterNode.bs.js";

var audioCtx = Curry._1(AudioContext$WebAudio.createAudioContext, /* () */0);

var lfo = LFO$WebAudio.connect(audioCtx.destination, LFO$WebAudio.setFrequency(10.0, LFO$WebAudio.make(audioCtx)));

var oscOne = Oscillator$WebAudio.connect(lfo.outputGain, Oscillator$WebAudio.make(/* Sine */0, audioCtx));

var oscOneEnvelope = Envelope$WebAudio.make(Oscillator$WebAudio.getEnvelopeGain(oscOne), audioCtx);

var oscTwoFilter = audioCtx.createBiquadFilter();

BiquadFilterNode$WebAudio.setType(oscTwoFilter, /* Lowpass */0);

oscTwoFilter.frequency.value = 370.0;

oscTwoFilter.frequency.setTargetAtTime(300.0, 2.0, 3.0);

oscTwoFilter.connect(lfo.outputGain);

var oscTwo = Oscillator$WebAudio.connect(oscTwoFilter, Oscillator$WebAudio.make(/* Sawtooth */2, audioCtx));

var oscTwoEnvelope = Envelope$WebAudio.make(Oscillator$WebAudio.getEnvelopeGain(oscTwo), audioCtx);

var state = {
  a: false
};

var Keyboard = {
  state: state
};

function trigger(e) {
  if (state.a === false && e.key === "a") {
    state.a = true;
    Envelope$WebAudio.trigger(oscOneEnvelope);
    return Envelope$WebAudio.trigger(oscTwoEnvelope);
  } else {
    return 0;
  }
}

function endTrigger(e) {
  if (e.key === "a") {
    state.a = false;
    Envelope$WebAudio.endTrigger(oscOneEnvelope);
    return Envelope$WebAudio.endTrigger(oscTwoEnvelope);
  } else {
    return 0;
  }
}

document.addEventListener("keydown", trigger);

document.addEventListener("keyup", endTrigger);

function startOscillators(_event) {
  audioCtx.resume();
  Oscillator$WebAudio.start(oscOne);
  Oscillator$WebAudio.start(oscTwo);
  LFO$WebAudio.start(lfo);
  return /* () */0;
}

ReactDOMRe.renderToElementWithId(React.createElement(React.Fragment, undefined, React.createElement("div", {
              style: {
                position: "absolute",
                right: "0",
                top: "0"
              }
            }, React.createElement(Switch$WebAudio.make, {
                  toggle: startOscillators,
                  initialState: false,
                  children: "Power"
                })), React.createElement("div", undefined, React.createElement("h2", undefined, "Oscillator One"), React.createElement("div", undefined, React.createElement(Knob$WebAudio.make, {
                      name: "Frequency",
                      config: {
                        minValue: 1.0,
                        maxValue: 18000.0,
                        scale: /* Logarithmic */1,
                        size: 120
                      },
                      initialParamValue: Oscillator$WebAudio.getFrequency(oscOne).value,
                      setParamValue: (function (frequency) {
                          return Oscillator$WebAudio.setFrequency(frequency, oscOne);
                        })
                    }), React.createElement(Slider$WebAudio.make, {
                      name: "Gain",
                      param: Oscillator$WebAudio.getOscillatorGain(oscOne),
                      config: {
                        minValue: Pervasives.epsilon_float,
                        maxValue: 100.0
                      }
                    }), React.createElement("div", {
                      style: {
                        display: "inline-block"
                      }
                    }, React.createElement("div", undefined, React.createElement(Knob$WebAudio.make, {
                              name: "Attack",
                              config: {
                                minValue: Pervasives.epsilon_float,
                                maxValue: 2.0,
                                scale: /* Linear */0,
                                size: 60
                              },
                              initialParamValue: oscOneEnvelope.envelopeParams.attack,
                              setParamValue: (function (value) {
                                  return Envelope$WebAudio.update(/* Attack */Block.__(0, [value]), oscOneEnvelope);
                                })
                            }), React.createElement(Knob$WebAudio.make, {
                              name: "Decay",
                              config: {
                                minValue: Pervasives.epsilon_float,
                                maxValue: 5.0,
                                scale: /* Linear */0,
                                size: 60
                              },
                              initialParamValue: oscOneEnvelope.envelopeParams.decay,
                              setParamValue: (function (value) {
                                  return Envelope$WebAudio.update(/* Decay */Block.__(1, [value]), oscOneEnvelope);
                                })
                            })), React.createElement("div", undefined, React.createElement(Knob$WebAudio.make, {
                              name: "Sustain",
                              config: {
                                minValue: Pervasives.epsilon_float,
                                maxValue: 1.0,
                                scale: /* Linear */0,
                                size: 60
                              },
                              initialParamValue: oscOneEnvelope.envelopeParams.sustain,
                              setParamValue: (function (value) {
                                  return Envelope$WebAudio.update(/* Sustain */Block.__(2, [value]), oscOneEnvelope);
                                })
                            }), React.createElement(Knob$WebAudio.make, {
                              name: "Release",
                              config: {
                                minValue: Pervasives.epsilon_float,
                                maxValue: 5.0,
                                scale: /* Linear */0,
                                size: 60
                              },
                              initialParamValue: oscOneEnvelope.envelopeParams.release,
                              setParamValue: (function (value) {
                                  return Envelope$WebAudio.update(/* Release */Block.__(3, [value]), oscOneEnvelope);
                                })
                            }))))), React.createElement("div", undefined, React.createElement("h2", undefined, "Oscillator Two"), React.createElement("div", undefined, React.createElement(Knob$WebAudio.make, {
                      name: "Frequency",
                      config: {
                        minValue: 1.0,
                        maxValue: 18000.0,
                        scale: /* Logarithmic */1,
                        size: 120
                      },
                      initialParamValue: Oscillator$WebAudio.getFrequency(oscTwo).value,
                      setParamValue: (function (frequency) {
                          return Oscillator$WebAudio.setFrequency(frequency, oscTwo);
                        })
                    }), React.createElement(Slider$WebAudio.make, {
                      name: "Gain",
                      param: Oscillator$WebAudio.getOscillatorGain(oscTwo),
                      config: {
                        minValue: Pervasives.epsilon_float,
                        maxValue: 100.0
                      }
                    }))), React.createElement("div", undefined, React.createElement("h2", undefined, "LFO"), React.createElement("div", undefined, React.createElement(Knob$WebAudio.make, {
                      name: "Frequency",
                      config: {
                        minValue: 1.0,
                        maxValue: 30.0,
                        scale: /* Linear */0,
                        size: 80
                      },
                      initialParamValue: Oscillator$WebAudio.getFrequency(lfo.oscillatorNode).value,
                      setParamValue: (function (frequency) {
                          return Oscillator$WebAudio.setFrequency(frequency, lfo.oscillatorNode);
                        })
                    })))), "app");

export {
  audioCtx ,
  lfo ,
  oscOne ,
  oscOneEnvelope ,
  oscTwoFilter ,
  oscTwo ,
  oscTwoEnvelope ,
  Keyboard ,
  trigger ,
  endTrigger ,
  startOscillators ,
  
}
/* audioCtx Not a pure module */
